# Put here configuration related to environment and tools
# For a complete list of options, see:
# https://pyflow-wellies.readthedocs.io/latest/config/tools_config/#tool-types
ecflow_variables:
  MODULES_VERSION: "new"

tools:
# ---------- System modules ---------------------------------------------------
  modules:
    python:
      name: python3
      version: 3.10.10-01
    uv:
      name: uv
      version: 0.6.14

  packages:
    anemoi_datasets:
      type: git
      source: https://github.com/ecmwf/anemoi-datasets.git
      branch: "{anemoi_datasets_branch}"
      depends: [uv]
      post_script: "uv pip install --upgrade pip && uv pip install -e ."
    anemoi_training:
      type: git
      source: https://github.com/ecmwf/anemoi-core.git
      branch: "{anemoi_training_branch}"
      depends: [uv]
      post_script: "git fetch --unshallow && uv pip install --upgrade pip && uv pip install -e ./training[all,tests] -e ./graphs[all,tests] -e ./models[all,tests]"

  # --------Virtual envs --------------------------------------------------
  environments:
      datasets_env:
        type: venv
        # modules: [python, uv]
        packages: [anemoi_datasets]
        depends: [python]
      training_env:
        type: venv
        # modules: [python, uv]
        packages: [anemoi_training]
        depends: [python]

  # --------Environment variables -----------------------------------------
